<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<title>CityFix - Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{
background:#0b0f19;color:white;height:100vh;display:flex;justify-content:center;align-items:center;
}
.container{
width:360px;background:#111827;padding:25px;border-radius:14px;
border:1px solid rgba(255,255,255,0.1);box-shadow:0 0 15px rgba(0,0,0,.5);
}
.tabs{display:flex;justify-content:space-between;margin-bottom:20px;}
.tabs button{
width:33%;padding:8px;border:none;border-radius:6px;background:#1a2338;color:#aaa;
cursor:pointer;font-size:14px;
}
.tabs button.active{background:#4af;color:#000;font-weight:600;}
form{display:none;}
form.active{display:block;}
label{font-size:14px;margin-bottom:6px;display:block;}
input{
width:100%;padding:12px;margin-bottom:13px;border-radius:10px;
border:1px solid rgba(255,255,255,0.2);background:#0e1527;color:#fff;
}
button.submit{
width:100%;padding:12px;background:#4af;border:none;border-radius:10px;
color:#000;font-weight:600;cursor:pointer;font-size:15px;transition:.2s;
}
button.submit:hover{transform:scale(.97);}
.back{text-align:center;margin-top:10px;font-size:13px;cursor:pointer;color:#aaa;}
.back:hover{color:#4af;}
</style>
</head>

<body>

<div class="container">

<div class="tabs">
<button id="loginTab" class="active" onclick="switchTab('login')">Login</button>
<button id="signupTab" onclick="switchTab('signup')">Signup</button>
<button id="forgotTab" onclick="switchTab('forgot')">Forgot</button>
</div>

<!-- LOGIN FORM -->
<form id="loginForm" class="active">
<label>Email</label>
<input type="email" id="loginEmail" placeholder="Enter email">
<label>Password</label>
<input type="password" id="loginPass" placeholder="Enter password">
<button class="submit" onclick="loginUser(event)">Login</button>
</form>

<!-- SIGNUP -->
<form id="signupForm">
<label>Name</label>
<input type="text" id="name" placeholder="Full name">
<label>Email</label>
<input type="email" id="email" placeholder="Email">
<label>Password</label>
<input type="password" id="pass" placeholder="Password">
<button class="submit" onclick="signupUser(event)">Create Account</button>
</form>

<!-- FORGOT -->
<form id="forgotForm">
<label>Email</label>
<input type="email" id="resetEmail" placeholder="Registered email">
<label>New Password</label>
<input type="password" id="newPass" placeholder="New password">
<button class="submit" onclick="resetPass(event)">Reset Password</button>
</form>

<div class="back" onclick="goHome()">← Back to Home</div>
</div>

<script>
function switchTab(tab){
document.querySelectorAll("form").forEach(f=>f.classList.remove("active"));
document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
document.getElementById(tab+"Form").classList.add("active");
document.getElementById(tab+"Tab").classList.add("active");
}

// SIGNUP
function signupUser(e){
e.preventDefault();
let name=document.getElementById("name").value;
let email=document.getElementById("email").value;
let pass=document.getElementById("pass").value;
if(!name||!email||!pass){alert("Fill all fields");return;}

let user={id:Date.now(),name,email,pass};  // ⬅ user ID added for feedback system
localStorage.setItem("user",JSON.stringify(user));
alert("Account created! Login now");
switchTab('login');
}

// LOGIN
function loginUser(e){
e.preventDefault();
let email=document.getElementById("loginEmail").value;
let pass=document.getElementById("loginPass").value;
let user=JSON.parse(localStorage.getItem("user"));

if(!user||user.email!==email||user.pass!==pass){
alert("Incorrect email or password");
return;
}

localStorage.setItem("userLogged","true");
localStorage.setItem("userID",user.id); // ⬅ Save user ID for notification API
localStorage.setItem("userName",user.name);

window.location.href="dashboard.html"; // ⬅ Dashboard = report system
}

// RESET PASSWORD
function resetPass(e){
e.preventDefault();
let email=document.getElementById("resetEmail").value;
let newPass=document.getElementById("newPass").value;
let user=JSON.parse(localStorage.getItem("user"));
if(!user||user.email!==email){alert("Email not found");return;}

user.pass=newPass;
localStorage.setItem("user",JSON.stringify(user));
alert("Password updated");
switchTab('login');
}

// BACK
function goHome(){window.location.href="index.html";}

// AUTO redirect if already logged in
if(localStorage.getItem("userLogged")==="true"){
window.location.href="dashboard.html";
}
</script>

</body>
</html>
